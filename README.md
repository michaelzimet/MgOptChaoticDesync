<a href="https://doi.org/10.5281/zenodo.15595744"><img src="https://zenodo.org/badge/996283200.svg" alt="DOI"></a>

# Figures
The scripts beginning with Fig enable the user to reproduce the corresponding figure in the paper. Note these require the user to manually vary the constraint value and do a number of runs, as indicated in the comments. These scripts generate Figs 1-6 and Fig 10, whereas Figs 7-9 are generated by EBC. 

# Scripts
The scripts beginning with opt_bvp are used to compute the optimal input for each corresponding model by numerically solving a two-point boundary value problem.

# Functions
The functions beginning with func_opt and func_integrate are needed in the same Matlab folder to run the corresponding opt_bvp scripts. The interp function and EventsFunction are also needed.

# Phase Response Curves
The functions beginning with Z calculate the corresponding phase response curves and their first and second derivatives. The Mathematica notebook Zpp calculates derivatives for the HH model.

# Data Files
The script find_fourier computes Fourier coefficients for the RHH model using data from the Z_data and theta_data files.

# EBC
EBC_mz is used to generate Figs 7-9. EBC_mult is used to generate Fig 10.

These are specific implemenations of the Event-Based Control code published by Faranak Rajabi here: https://github.com/faranakR/HH-Stochastic-Control
and require the functions folder from that repository to be present in the same Matlab folder. 
